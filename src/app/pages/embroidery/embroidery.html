<div class="products-container">
  <div class="page-header">
    <h1>
      <mat-icon>palette</mat-icon>
      Bordados
    </h1>
    <p class="subtitle">Gerencie as ordens de serviÃ§o e prazos de entrega</p>
  </div>

  <div class="cards">
    <div class="card blue">
      <div class="info">
        <span>Total</span>
        <strong>{{ totalElements() }}</strong>
        <small>Bordados</small>
      </div>
      <mat-icon class="icon">format_list_bulleted</mat-icon>
    </div>

    <div class="card orange">
      <div class="info">
        <span>Atrasados</span>
        <strong>{{ overdueCount() }}</strong>
      </div>
      <mat-icon class="icon">priority_high</mat-icon>
    </div>

    <div class="card green">
      <div class="info">
        <span>Para Hoje</span>
        <strong>{{ todayCount() }}</strong>
      </div>
      <mat-icon class="icon">event_available</mat-icon>
    </div>

    <div class="card purple"> <div class="info">
    <span>A Entregar</span>
    <strong>{{ pendingCount() }}</strong>
    <small>Bordados Pendentes</small>
  </div>
  <mat-icon class="icon">pending_actions</mat-icon>
</div>
  </div>

  <div class="search-filters">
  <div class="search-box">
    <div class="input-box">
      <mat-icon class="search-icon">search</mat-icon>
      <input
        type="text"
        placeholder="Buscar por cliente, descriÃ§Ã£o ou ID..."
        [formControl]="searchControl"
      >
    </div>
  </div>

  <div class="filter-actions">
    <button (click)="toggleDelivered()" 
            class="btn-filter" 
            [class.active]="showDelivered()">
      <mat-icon>{{ showDelivered() ? 'assignment_turned_in' : 'history' }}</mat-icon>
      {{ showDelivered() ? 'Ver Tudo' : 'Ver Entregues' }}
    </button>
  </div>

  <div class="new-product-btn">
    <button (click)="openModal()" class="btn-primary">
      <mat-icon>add</mat-icon>
      Novo Bordado
    </button>
  </div>
</div>

  <div *ngIf="loading()" class="search-loading">
    <mat-icon class="loading-spinner">refresh</mat-icon>
    Buscando bordados...
  </div>

 <div class="table-container">
  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th class="col-id center">CÃ“DIGO</th>
          <th class="col-name">ğŸ‘¤ Cliente</th>
          <th class="col-description">ğŸ“ DescriÃ§Ã£o</th>
          <th class="col-price center">ğŸ’° PreÃ§o</th>
          <th class="col-date center">ğŸ“… Entrega</th>
          <th class="col-status center">ğŸ“Œ Status</th>
          <th class="col-actions center">âš™ï¸ AÃ§Ãµes</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngIf="!loading() && dataSource().length === 0">
          <td colspan="7" class="empty-state">
            <mat-icon>search_off</mat-icon>
            <p>Nenhum bordado encontrado</p>
          </td>
        </tr>

        <tr *ngFor="let e of dataSource()" [class.late-row]="isOverdue(e.deliveryDate) && e.status === 'PENDING'">
          <td class="col-id center">#{{ e.id }}</td>
          <td class="col-name"><strong>{{ e.customerName }}</strong></td>
          <td class="col-description">{{ e.description }}</td>
          <td class="col-price center">R$ {{ e.price | number:'1.2-2' }}</td>
          <td class="col-date center">
            <span class="delivery-badge" [class.late]="isOverdue(e.deliveryDate) && e.status === 'PENDING'">
              {{ e.deliveryDate | date:'dd/MM/yyyy' }}
            </span>
          </td>
          <td class="col-status center">
            <span class="status-badge" [class.delivered]="e.status === 'DELIVERED'">
              {{ e.status === 'DELIVERED' ? 'Entregue' : 'Pendente' }}
            </span>
          </td>
          <td class="col-actions center">
            <div class="action-buttons">
              <button mat-icon-button *ngIf="e.status !== 'DELIVERED'" (click)="markAsDelivered(e)" matTooltip="Entregar">
                <mat-icon color="primary">check_circle</mat-icon>
              </button>
              <button mat-icon-button (click)="openModal(e)" matTooltip="Editar">
                <mat-icon>edit</mat-icon>
              </button>
              <button mat-icon-button (click)="delete(e.id)" matTooltip="Excluir">
                <mat-icon color="warn">delete</mat-icon>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
   <div class="pagination-container" *ngIf="totalElements() > 0">
    <div class="pagination-info">
      Mostrando {{ getStartIndex() }} - {{ getEndIndex() }} de {{ totalElements() }}
    </div>
    <div class="pagination-buttons">
      <button class="pagination-btn" (click)="changePage(-1)" [disabled]="currentPage() === 0">
        <mat-icon>chevron_left</mat-icon>
      </button>
      <button class="pagination-btn active">{{ currentPage() + 1 }}</button>
      <button class="pagination-btn" (click)="changePage(1)" [disabled]="(currentPage() + 1) * pageSize() >= totalElements()">
        <mat-icon>chevron_right</mat-icon>
      </button>
    </div>
  </div>
</div>
 
  <div class="table-stats">
    Total: <strong>{{ totalElements() }}</strong> bordados
</div>